define [
  'require'
  'soteria.public-key-envelope'
], (require) ->

  BASE64_PUBLIC_KEY = 'MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAjPtMyZrsuhw+nvKPsRAcB1fJIwMFW9r\
    Ad/5glplluslPPvHDllPZU2arJzUwCFAYnZaMS8X8AQx3qeKJagumW35I2ce4ZcFRIpjugw3iDDsbB5rq/GEpToneEbD8U\
    zKRBUDF7gH7YzyVBLkTNuNTXgpUI0lLFCeBu/D6IaMk0ETDpnI48c13Pf82Tn9r8rLeDkO4eiN8kxIfm7wvj3JWWs3jDqQ\
    8NpBea2de2/maB8pBqXMv4mtv6zyDy7edQPRwYopJxB7R9GNiueCsp0whojbf0KmsAZkRlMrsKup6uIfZE7QmiQdZP4l0f\
    QdvAdL9u/UPRxlIiXrmaknJIota0LjT0ghtDtLk8ix8SLGHOmELOe2w0xTXQEduDbTKgP24cM/iETb3aqsD6T0jLUFtFIy\
    pCnQLDRLhTzae6cmoFvpruq2gfM+VemjmYM7QdVKAbm+hexspgGo8j4KGEmxYxoFd26ar/WmYF8VQIVoiziGW/mOcHAohT\
    W1cQkI18w3s+72UL4X1e8EHGu3bpc4oBpS6cXTeHpaUlDJzZPg4YFL+brCb/4HxF31zLnG/OOVRzVxe2DRwlZzEdNlCZir\
    Bd+hgGfjPpYYf/yBzcKKliCZ+4W7lzHePCKz0/0ygPb+qmgUOdUdZy8Ip0va7RFilp8zFDDqFAiwDYz+nq7xJPE0CAwEAA\
    Q=='


  MOCK_HTTP_RESPONSE = { publicKey : BASE64_PUBLIC_KEY }

  EXPECTED_PUBLIC_KEY = {
    n : {
      data : [
        206126157,66747067,36438883,12822608,94883013,196363658,36295414,74816700,168103541,
        64748201,83840160,149981903,249941111,40365590,10659208,267519799,262506015,100769676,
        180451304,227812962,94159988,226707209,30235742,200511061,225652337,136253815,246455295,
        101003238,56948792,155796263,81665686,155952919,97396742,28237242,91996423,155383903,
        233634749,69426992,225270850,29401620,117334940,36495897,89137498,110723452,195472381,
        208147933,101870680,63502376,187269226,117053361,89292910,101510407,91908326,168283385,
        174832301,211452271,255237865,13708820,151680011,114378954,220409153,179322515,20379498,
        118292001,176225720,115399500,81215559,249236785,174132025,76224627,82979964,114355502,
        148099592,146124043,172607778,144158310,256317768,266059600,124715474,144132048,151476543,
        20660840,179865561,247639719,152147146,177913881,37150672,175424026,45736108,220153398,
        172606494,256312872,196582720,246663228,266496879,68851506,161089482,108391871,110124651,
        15352771,106614243,49870629,35625916,37210417,239319162,254488032,105807723,125034483,
        37286349,72104551,27469008,197070754,185870209,88224916,55795210,194065262,54301956,
        249569206,17121477,264581929,165548464,101881064,127593212,12825008,243469794,85076366,
        129525185,132418972,168535643,178137238,201395319,147111007,1613206,55771269,57060135,
        157629845,255783363,106671252,241211033,229377919,50529627,7699602,263262236,65662760,
        183286300,263507097,140
      ],
      t    : 147,
      s    : 0
    },
    e : {
      data : [65537],
      t    : 1,
      s    : 0
    }
  }

  PublicKeyEnvelope = require 'soteria.public-key-envelope'

  describe 'PublicKeyEnvelope', ->

    it 'should compute a known public key', ->
      envelope = new PublicKeyEnvelope(MOCK_HTTP_RESPONSE)
      publicKeyWithoutFunctions = JSON.parse(JSON.stringify(envelope.toRsaPublicKey()))
      expect(publicKeyWithoutFunctions).toEqual(EXPECTED_PUBLIC_KEY)
